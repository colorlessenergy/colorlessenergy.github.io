I"»<h3 id="pwa-lastpad-take-notes-offline">PWA lastpad take notes offline</h3>

<p class="project__intro">
 <a href="https://lastpad.herokuapp.com/">visit Site</a>
</p>
<p class="project__intro">
 <a href="https://github.com/colorlessenergy/lastpad">visit Github</a>
</p>

<p><a href="https://lastpad.herokuapp.com/">
   <img src="/images/lastpad.png" alt="PWA lastpad to access notes offline" title="PWA lastpad to access notes offline" />
</a></p>

<h2 id="what-is-this">what is this</h2>

<p>A progressive web app that allows you to take notes offline and have them be updated and saved as soon as you get back on an internet connection. With this web app, I designed and developed a REST API to allow me to issue CRUD operations from the frontend. This web app was designed in Figma and utilize React to implement the design.</p>

<h2 id="how-to-use">how to use</h2>

<p>You have to create an account to use this web app to be able to save your notes and have them accessible everywhere you sign in. When you create an account you will be able to view, edit, create and delete your notes offline and online. When the web app is loaded it will prompt you to download it to your device.</p>

<p>If you donâ€™t want to create an account you can use this one</p>

<p>Email: test@gmail.com Password: test</p>

<h2 id="built-with">Built with</h2>

<ul>
  <li>HTML</li>
  <li>CSS</li>
  <li>JavaScript</li>
  <li>React - Create React App</li>
  <li>Redux</li>
  <li>Redux-Thunk</li>
  <li>Node</li>
  <li>JWT for authentication</li>
  <li>Express</li>
  <li>MongoDB</li>
  <li>Mongoose</li>
  <li>PWA - service worker</li>
</ul>

<h2 id="challenges-and-knowledge-acquired">challenges and knowledge acquired</h2>

<h3 id="difficulties-of-displaying-html-with-react">difficulties of displaying HTML with React</h3>

<p>React by default escapes and sanitizes anything that comes from a variable before it is put into JSX to protect from XSS attack. This created a problem for me because when a note was created it will be saved as HTML and when rendered into the page the literal tags will be shown instead of just the content.</p>

<p>To fix this issue I used the library <a href="https://www.npmjs.com/package/react-render-html">react-render-html</a> It took a string and created React Elements.</p>

<p>I know React has a way to <a href="https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml">set HTML from a variable</a> called <code class="highlighter-rouge">dangerouslySetInnerHTML</code> It makes it so that React will not escape the HTML when putting into JSX.</p>

<p>Knowing that all it does is not escape the HTML I decided to just use <code class="highlighter-rouge">react-render-html</code> because it creates React Elements.</p>

<h3 id="service-worker">service worker</h3>

<p>The service worker was really easy to set up with Create React App all you need to do is allow it to register a service worker for you and it cached certain assets and allowed the user to download the web app to there home screen.</p>

<h3 id="edit-create-and-delete-note-operations-offline">edit, create and delete note operations offline</h3>

<p>To make the web app useable offline the service worker cached all resources needed.</p>

<p>Every operation that can be done on a note had a different array so there was an <code class="highlighter-rouge">allNotes</code> array which was populated initially when the user loads into the dashboard with all their notes, <code class="highlighter-rouge">deletedNotes</code> array, <code class="highlighter-rouge">createdNotes</code> array, and <code class="highlighter-rouge">updatedNotes</code> array. These arrays were stored in localStorage.</p>

<p>Every time someone would try to make a CRUD operation for notes it would first check if there are online by using <code class="highlighter-rouge">navigator.onLine</code>. <code class="highlighter-rouge">navigator.onLine</code> isnâ€™t a very good way to check if the user is connected to an internet connection because it will be true if the user is connected to a network.</p>

<p>If the <code class="highlighter-rouge">navigator.onLine</code> was true it would just make a fetch request otherwise if it was false or the fetch failed it would try to make the operation offline using the arrays in localStorage.</p>

<p>I have a JavaScript timer that runs every 5 seconds to check if the user went back online and there was changes made offline to send requests to the backend to create the new changes in MongoDB.</p>

<h4 id="this-is-the-general-idea-that-happens-with-every-operation">this is the general idea that happens with every operation</h4>

<p>If a note was created and the user was offline it would first check if the <code class="highlighter-rouge">createdNotes</code> array had anything inside If It didnâ€™t it would set an array with the note that was created then it would use <code class="highlighter-rouge">JSON.stringfy()</code> to make sure the objects are saved and not turned into <code class="highlighter-rouge">[object Object,...object Object]</code>. If the <code class="highlighter-rouge">createdNotes</code> was already created it would <code class="highlighter-rouge">JSON.parse()</code> the <code class="highlighter-rouge">createdNotes</code> array and push the new one into the array then <code class="highlighter-rouge">JSON.stringfy()</code> it.</p>

<h4 id="issue-with-creating-notes-offline-and-going-online">issue with creating notes offline and going online</h4>

<p>An issue I had with the arrays was if someone were to edit or delete a note that was created offline and the user goes online it would try to make changes to the Database with these fake notes that had fake Ids. This threw errors and to fix this I first check if it the note that was being made changes to is inside the <code class="highlighter-rouge">createdNotes</code> arrays if it was it would edit or delete the note inside that array instead of pushing it into a new array which could have been <code class="highlighter-rouge">updatedNotes</code> and deletedNotes`.</p>
:ET