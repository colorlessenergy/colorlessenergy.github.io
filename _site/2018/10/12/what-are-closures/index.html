<!DOCTYPE html>
<html lang="en-US">
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-124255310-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() { dataLayer.push(arguments); }
      gtag('js', new Date());

      gtag('config', 'UA-124255310-1');
    </script>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <!-- seo -->
    <meta name="description" content="A explanation on what closures are in javascript. A closure is a function that refer to variables declared by a parent function. This is only possible because of lexical scoping. Brian Munoz, Front End Web Developer, California">

    <meta property="og:title" content="what are closures · Brian Munoz, Front End Web Developer, California">
    <meta property="og:type" content="website">
    <meta property="og:description" content="A explanation on what closures are in javascript. A closure is a function that refer to variables declared by a parent function. This is only possible because of lexical scoping. Brian Munoz, Front End Web Developer, California">
    <title>
      
        what are closures · Brian Munoz, Front End Web Developer, California
      
    </title>


    <meta itemprop="keywords" content="javascript" />
    
    <meta property="article:tag" content="javascript">
    

    

    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link rel="stylesheet" href="/css/main.css">
  </head>
  <body>
    <main>
      <div class="nav__fixed">
  <nav class="row ">
    <h3> <a class="list-item__active list-item__link" href="/">brian</a> </h3>
    <ul class="list">
      <li class="list-item"> <a class="list-item__link" href="/work">Projects</a> </li>
      <li class="list-item"> <a class="list-item__link" href="/blog">Blog</a> </li>
      <li class="list-item"> <a class="list-item__link" href="/contact">Contact</a> </li>
    </ul>
  </nav>
</div>

      <div class="contain-proj">
  <section class="proj">
    <div class="proj__contain">
      <h1 id="what-are-closures">what are closures</h1>

<p><img src="/images/javascript.png" alt="javascript" title="a picture of javascript" /></p>

<h2 id="closures-definition">closures definition</h2>

<p>Closure isn’t a new thing it actually is used everywhere.</p>

<p>A closures is when a function can remember its lexical scope even if the function is executed outside its lexical scope.
which means if a function is executed outside where it is declared and is using a variable declared around the function,
this is a closure. If you have been using JavaScript for a week you have already used a closure. I encourage you guys to run the code snippets in the console!</p>

<p>In more simpler terms a closure is a function that refers to a variables declared by a parent function. If you still don’t understand look at the examples then come back to this!</p>

<h2 id="closures-example">closures example</h2>

<p>A example of a closure is when a function is called as a callback to another function see the example below.
which means that the function is called through another function because it is passed through as a parameter and remembers what foo is even though it is in another scope.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">bar</span> <span class="p">()</span> <span class="p">{</span>
 <span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="s2">"foo"</span><span class="p">;</span>
 <span class="kd">function</span> <span class="nx">baz</span> <span class="p">()</span> <span class="p">{</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">)</span>
 <span class="p">}</span>

 <span class="nx">bam</span><span class="p">(</span><span class="nx">baz</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">bam</span> <span class="p">(</span><span class="nx">baz</span><span class="p">)</span> <span class="p">{</span>
 <span class="nx">baz</span><span class="p">();</span>
 <span class="c1">// remembers what 'foo' was</span>
 <span class="c1">// prints 'foo'</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The JavaScript timer function could be used as a closure. The setTimeout is called a second later by the time it is called you would think that the function is done executing and removed. Since closures exist bar is still stored in memory until it is not needed anymore.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">foo</span> <span class="p">()</span> <span class="p">{</span>
 <span class="kd">var</span> <span class="nx">bar</span> <span class="o">=</span> <span class="s2">"bar"</span><span class="p">;</span>

 <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bar</span><span class="p">);</span>
 <span class="p">},</span> <span class="mi">1000</span><span class="p">)</span>
<span class="p">};</span>

<span class="nx">foo</span><span class="p">();</span>
 <span class="c1">// prints 'bar'</span>
</code></pre></div></div>

<p>After executing foo then after the setTimeout is done running it will still remember the value of the variable bar.</p>

<p>The event handler callback is enclosed in a function which means it remembers anything declared and defined around it. this is a closure because you never know when the button is going to be clicked and it will always print out ‘bar’ since it has a reference to it. To remove the closure you would have to unbind the event listener.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">foo</span> <span class="p">()</span> <span class="p">{</span>
 <span class="kd">var</span> <span class="nx">bar</span> <span class="o">=</span> <span class="s2">"bar"</span><span class="p">;</span>

 <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">".btn"</span><span class="p">)</span>
   <span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
     <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bar</span><span class="p">)</span>
   <span class="p">})</span>
<span class="p">}</span>

<span class="nx">foo</span><span class="p">()</span>
 <span class="c1">// prints 'bar'</span>
 <span class="c1">// the value of bar is still remembered</span>
</code></pre></div></div>

<p>Another example would be using for loops. the example below will print 6, 6 times in the console since it is only using one
variable. There are a lot of ways to fix this but, in my opinion the best way to fix this is use ‘let’ instead of ‘var’ in the for loop. This is the easiest way to fix it.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
 <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"i: "</span> <span class="o">+</span> <span class="nx">i</span><span class="p">);</span>
   <span class="c1">// print i: 6, 6 times</span>
 <span class="p">},</span> <span class="nx">i</span><span class="o">*</span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Best solution is using let. I would even say
to just use ‘let’ instead of ‘var’ in every for loop!</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span><span class="mi">5</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
 <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"i: "</span> <span class="o">+</span> <span class="nx">i</span><span class="p">);</span>
     <span class="c1">// print i: + the current i</span>
 <span class="p">},</span> <span class="nx">i</span><span class="o">*</span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>functions that refer to variables declared by a parent function.
only possible because of lexical scoping</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">makeHelloFunction</span><span class="p">()</span> <span class="p">{</span>
 <span class="kd">let</span> <span class="nx">message</span> <span class="o">=</span> <span class="s1">'hello, world'</span><span class="p">;</span>

 <span class="kd">function</span> <span class="nx">logMessage</span><span class="p">()</span> <span class="p">{</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span>
 <span class="p">}</span>

 <span class="k">return</span> <span class="nx">logMessage</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Within <span class="highlight__code">makeHelloFunction()</span> we are creating the message variable, and using the variable within a new function and returning that function.</p>

<p>in the function <span class="highlight__code">logMessage()</span> no where in it message is defined. It gets it from the parent function.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">makeHelloFunction</span><span class="p">()</span> <span class="p">{</span>
 <span class="kd">let</span> <span class="nx">message</span> <span class="o">=</span> <span class="s1">'hello, world'</span><span class="p">;</span>

 <span class="kd">function</span> <span class="nx">logMessage</span><span class="p">()</span> <span class="p">{</span>
   <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span>
 <span class="p">}</span>

 <span class="k">return</span> <span class="nx">logMessage</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">let</span> <span class="nx">sayHello</span> <span class="o">=</span> <span class="nx">makeHelloFunction</span><span class="p">();</span>

<span class="nx">sayHello</span><span class="p">();</span>
<span class="c1">// hello, world</span>
</code></pre></div></div>

<p>If we run <span class="highlight__code">makeHelloFunction()</span> it will declare the variable message it will create the function <span class="highlight__code">logMessage()</span> and return the <span class="highlight__code">logMessage()</span>.</p>

<p>What will happen if we ran <span class="highlight__code">sayHello()</span> ?</p>

<p>It will log hello, world. this is possible because of lexical scoping.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">makeFunctionArray</span><span class="p">()</span> <span class="p">{</span>
 <span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span>

 <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
     <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>
   <span class="p">})</span>
 <span class="p">}</span>

 <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">arrWithNumbers</span> <span class="o">=</span> <span class="nx">makeFunctionArray</span><span class="p">();</span>
</code></pre></div></div>

<p>We have a function that creates a array. In the for loop the initializer is declared with the <span class="highlight__code">var</span> keyword. pushed a function that console logs i to the array 5 times returns the array then we store the array in a variable.</p>

<p>now lets try calling one of the functions.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">makeFunctionArray</span><span class="p">()</span> <span class="p">{</span>
 <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span>

 <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
     <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>
   <span class="p">})</span>
 <span class="p">}</span>

 <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">arrWithNumbers</span> <span class="o">=</span> <span class="nx">makeFunctionArray</span><span class="p">();</span>

<span class="nx">arrWithNumbers</span><span class="p">[</span><span class="mi">0</span><span class="p">]();</span>
 <span class="c1">// 5</span>
</code></pre></div></div>
<p>It is 5 because of closures. to fix this use the variable declaration <span class="highlight__code">let</span> or <span class="highlight__code">const</span> or encapsulate it into a IIFE.</p>

<p>now what is a iife ?</p>

<h2 id="immediately-invoked-function-expression">immediately invoked function expression</h2>

<ul>
  <li>A function expression that get invoked immediately</li>
  <li>It creates a closure.</li>
  <li>Doesn’t add to or modify the global object</li>
</ul>

<p>this is how a iife looks like</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

 <span class="c1">// this variable will not exist</span>
 <span class="c1">// after console.log is executed</span>
 <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>

 <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'hi'</span><span class="p">)</span>
<span class="p">})();</span>
<span class="c1">// will console log hi</span>
</code></pre></div></div>

<p>Why use IIFE?</p>

<p>use this so it doesn’t poluate the global scope or you want to create a closure.</p>

<p>now let’s fix the problem we had earlier</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">makeFunctionArray</span><span class="p">()</span> <span class="p">{</span>
 <span class="kd">var</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span>

 <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span>
     <span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">return</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span>
      <span class="p">}</span>
     <span class="p">})(</span><span class="nx">i</span><span class="p">)</span>
   <span class="p">);</span>
 <span class="p">}</span>

 <span class="k">return</span> <span class="nx">arr</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">arrWithNumbers</span> <span class="o">=</span> <span class="nx">makeFunctionArray</span><span class="p">();</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arrWithNumbers</span><span class="p">[</span><span class="mi">0</span><span class="p">]();)</span>
 <span class="c1">// 0</span>
</code></pre></div></div>

<p>we have a function that returns another anonymous function that console logs x. x is the parameter that is taken from the parent function. the child still has reference to the scope of the parent. primitives are passed by value and not by reference it actually creates a new value for every iteration of the function and creates a closure from the parent to the child.</p>

<h2 id="conclusion">conclusion</h2>

<p>Closures aren’t anything new and you probably have been using this without even realizing. Now these aren’t happy accidents
anymore you should be able to recognize and use them to your advantage.</p>

<p>A closure is a function that refer to variables declared by a parent function.
This is only possible because of lexical scoping.</p>

<p>happy coding!</p>


    </div>
  </section>
</div>


  <footer>
  <article class="blog-pagination">
    
    <div class="blog-pagination__wrapper">
      <a class="blue" href="/2018/10/08/is-javascript-synchronous-async-single-threaded/">
        <div class="blog-pagination__img"
        style="background-image:url(/images/javascript.png)"></div>
        <div class="blog-pagination__contain">
          <h3 class="blog-pagination__title">is JavaScript synchronous, async, or single threaded</h3>
          <p class="blog-pagination__author">brian munoz</p>
        </div>
      </a>
    </div>
    

    
    <div class="blog-pagination__wrapper">
      <a class="blue" href="/2018/10/15/7-git-commands-that-every-developer-should-know/">
        <div class="blog-pagination__img"
          style="background-image:url(/images/javascript.png)"></div>
        <div class="blog-pagination__contain">
          <h3 class="blog-pagination__title">7 git commands that every developer should know.</h3>
          <p class="blog-pagination__author">brian munoz</p>
        </div>
      </a>
      </div>
    
  </article>

  <!-- Begin MailChimp Signup Form -->
<div id="mc_embed_signup">
  <form action="https://github.us19.list-manage.com/subscribe/post?u=b830a3ad9fcc1205b5721dcf4&amp;id=ebb1855b1f" method="post"
    id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate form" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
      <h3>join my newsletter for updates when I post content about all things related to web development.</h3>
      <div class="mc-field-group form__group">
        <label for="mce-EMAIL" class="form__label">Email Address </label>
        <input placeholder="Email..." type="email" value="" name="EMAIL" class="required email form__email" id="mce-EMAIL">
      </div>
      <div id="mce-responses" class="clear">
        <div class="response" id="mce-error-response" style="display:none"></div>
        <div class="response" id="mce-success-response" style="display:none"></div>
      </div>
      <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
      <div style="position: absolute; left: -5000px;" aria-hidden="true">
        <input type="text" name="b_b830a3ad9fcc1205b5721dcf4_ebb1855b1f" tabindex="-1" value="">
      </div>
      <div class="clear">
        <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="work__link form__button button">
      </div>
    </div>
  </form>
</div>

<!--End mc_embed_signup-->
</footer>

    </main>
  </body>
</html>
